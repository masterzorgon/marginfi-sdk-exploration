import { BankMetadata, WrappedI80F48, Amount } from "@mrgnlabs/mrgn-common";
import { PublicKey } from "@solana/web3.js";
import BigNumber from "bignumber.js";
import BN from "bn.js";
import { MarginRequirementType } from "./account";
import { PriceBias, OraclePrice } from "./price";
import { MarginfiIdlType } from "../idl";
import { PythPushFeedIdMap } from "../utils";
interface BankRaw {
    mint: PublicKey;
    mintDecimals: number;
    group: PublicKey;
    assetShareValue: WrappedI80F48;
    liabilityShareValue: WrappedI80F48;
    liquidityVault: PublicKey;
    liquidityVaultBump: number;
    liquidityVaultAuthorityBump: number;
    insuranceVault: PublicKey;
    insuranceVaultBump: number;
    insuranceVaultAuthorityBump: number;
    collectedInsuranceFeesOutstanding: WrappedI80F48;
    feeVault: PublicKey;
    feeVaultBump: number;
    feeVaultAuthorityBump: number;
    collectedGroupFeesOutstanding: WrappedI80F48;
    totalLiabilityShares: WrappedI80F48;
    totalAssetShares: WrappedI80F48;
    lastUpdate: BN;
    config: BankConfigRaw;
    flags: BN;
    emissionsRate: BN;
    emissionsMint: PublicKey;
    emissionsRemaining: WrappedI80F48;
}
interface BankConfigRaw {
    assetWeightInit: WrappedI80F48;
    assetWeightMaint: WrappedI80F48;
    liabilityWeightInit: WrappedI80F48;
    liabilityWeightMaint: WrappedI80F48;
    depositLimit: BN;
    borrowLimit: BN;
    riskTier: RiskTierRaw;
    totalAssetValueInitLimit: BN;
    interestRateConfig: InterestRateConfigRaw;
    operationalState: OperationalStateRaw;
    oracleSetup: OracleSetupRaw;
    oracleKeys: PublicKey[];
}
interface BankConfigCompactRaw extends Omit<BankConfigRaw, "oracleKeys"> {
    oracle?: {
        setup: OracleSetupRaw;
        keys: PublicKey[];
    };
    oracleKey: PublicKey;
    auto_padding_0: number[];
    auto_padding_1: number[];
}
type RiskTierRaw = {
    collateral: {};
} | {
    isolated: {};
};
type OperationalStateRaw = {
    paused: {};
} | {
    operational: {};
} | {
    reduceOnly: {};
};
interface InterestRateConfigRaw {
    optimalUtilizationRate: WrappedI80F48;
    plateauInterestRate: WrappedI80F48;
    maxInterestRate: WrappedI80F48;
    insuranceFeeFixedApr: WrappedI80F48;
    insuranceIrFee: WrappedI80F48;
    protocolFixedFeeApr: WrappedI80F48;
    protocolIrFee: WrappedI80F48;
}
type OracleSetupRaw = {
    none: {};
} | {
    pythLegacy: {};
} | {
    switchboardV2: {};
} | {
    pythPushOracle: {};
};
export type { BankRaw, BankConfigRaw, BankConfigCompactRaw, RiskTierRaw, InterestRateConfigRaw, OracleSetupRaw };
declare class Bank {
    address: PublicKey;
    tokenSymbol: string | undefined;
    group: PublicKey;
    mint: PublicKey;
    mintDecimals: number;
    assetShareValue: BigNumber;
    liabilityShareValue: BigNumber;
    liquidityVault: PublicKey;
    liquidityVaultBump: number;
    liquidityVaultAuthorityBump: number;
    insuranceVault: PublicKey;
    insuranceVaultBump: number;
    insuranceVaultAuthorityBump: number;
    collectedInsuranceFeesOutstanding: BigNumber;
    feeVault: PublicKey;
    feeVaultBump: number;
    feeVaultAuthorityBump: number;
    collectedGroupFeesOutstanding: BigNumber;
    lastUpdate: number;
    config: BankConfig;
    totalAssetShares: BigNumber;
    totalLiabilityShares: BigNumber;
    emissionsActiveBorrowing: boolean;
    emissionsActiveLending: boolean;
    emissionsRate: number;
    emissionsMint: PublicKey;
    emissionsRemaining: BigNumber;
    oracleKey: PublicKey;
    constructor(address: PublicKey, mint: PublicKey, mintDecimals: number, group: PublicKey, assetShareValue: BigNumber, liabilityShareValue: BigNumber, liquidityVault: PublicKey, liquidityVaultBump: number, liquidityVaultAuthorityBump: number, insuranceVault: PublicKey, insuranceVaultBump: number, insuranceVaultAuthorityBump: number, collectedInsuranceFeesOutstanding: BigNumber, feeVault: PublicKey, feeVaultBump: number, feeVaultAuthorityBump: number, collectedGroupFeesOutstanding: BigNumber, lastUpdate: BN, config: BankConfig, totalAssetShares: BigNumber, totalLiabilityShares: BigNumber, emissionsActiveBorrowing: boolean, emissionsActiveLending: boolean, emissionsRate: number, emissionsMint: PublicKey, emissionsRemaining: BigNumber, oracleKey: PublicKey, tokenSymbol?: string);
    static decodeBankRaw(encoded: Buffer, idl: MarginfiIdlType): BankRaw;
    static fromBuffer(address: PublicKey, buffer: Buffer, idl: MarginfiIdlType, feedIdMap: PythPushFeedIdMap): Bank;
    static fromAccountParsed(address: PublicKey, accountParsed: BankRaw, feedIdMap: PythPushFeedIdMap, bankMetadata?: BankMetadata): Bank;
    getTotalAssetQuantity(): BigNumber;
    getTotalLiabilityQuantity(): BigNumber;
    getAssetQuantity(assetShares: BigNumber): BigNumber;
    getLiabilityQuantity(liabilityShares: BigNumber): BigNumber;
    getAssetShares(assetQuantity: BigNumber): BigNumber;
    getLiabilityShares(liabilityQuantity: BigNumber): BigNumber;
    computeAssetUsdValue(oraclePrice: OraclePrice, assetShares: BigNumber, marginRequirementType: MarginRequirementType, priceBias: PriceBias): BigNumber;
    computeLiabilityUsdValue(oraclePrice: OraclePrice, liabilityShares: BigNumber, marginRequirementType: MarginRequirementType, priceBias: PriceBias): BigNumber;
    computeUsdValue(oraclePrice: OraclePrice, quantity: BigNumber, priceBias: PriceBias, weightedPrice: boolean, weight?: BigNumber, scaleToBase?: boolean): BigNumber;
    computeQuantityFromUsdValue(oraclePrice: OraclePrice, usdValue: BigNumber, priceBias: PriceBias, weightedPrice: boolean): BigNumber;
    getPrice(oraclePrice: OraclePrice, priceBias?: PriceBias, weightedPrice?: boolean): BigNumber;
    getAssetWeight(marginRequirementType: MarginRequirementType, oraclePrice: OraclePrice, ignoreSoftLimits?: boolean): BigNumber;
    getLiabilityWeight(marginRequirementType: MarginRequirementType): BigNumber;
    computeTvl(oraclePrice: OraclePrice): BigNumber;
    computeInterestRates(): {
        lendingRate: BigNumber;
        borrowingRate: BigNumber;
    };
    computeBaseInterestRate(): BigNumber;
    computeUtilizationRate(): BigNumber;
    computeRemainingCapacity(): {
        depositCapacity: BigNumber;
        borrowCapacity: BigNumber;
    };
    describe(oraclePrice: OraclePrice): string;
}
declare class BankConfig {
    assetWeightInit: BigNumber;
    assetWeightMaint: BigNumber;
    liabilityWeightInit: BigNumber;
    liabilityWeightMaint: BigNumber;
    depositLimit: BigNumber;
    borrowLimit: BigNumber;
    riskTier: RiskTier;
    totalAssetValueInitLimit: BigNumber;
    interestRateConfig: InterestRateConfig;
    operationalState: OperationalState;
    oracleSetup: OracleSetup;
    oracleKeys: PublicKey[];
    constructor(assetWeightInit: BigNumber, assetWeightMaint: BigNumber, liabilityWeightInit: BigNumber, liabilityWeightMaint: BigNumber, depositLimit: BigNumber, borrowLimit: BigNumber, riskTier: RiskTier, totalAssetValueInitLimit: BigNumber, oracleSetup: OracleSetup, oracleKeys: PublicKey[], interestRateConfig: InterestRateConfig, operationalState: OperationalState);
    static fromAccountParsed(bankConfigRaw: BankConfigRaw): BankConfig;
}
declare enum RiskTier {
    Collateral = "Collateral",
    Isolated = "Isolated"
}
declare enum OperationalState {
    Paused = "Paused",
    Operational = "Operational",
    ReduceOnly = "ReduceOnly"
}
interface InterestRateConfig {
    optimalUtilizationRate: BigNumber;
    plateauInterestRate: BigNumber;
    maxInterestRate: BigNumber;
    insuranceFeeFixedApr: BigNumber;
    insuranceIrFee: BigNumber;
    protocolFixedFeeApr: BigNumber;
    protocolIrFee: BigNumber;
}
declare enum OracleSetup {
    None = "None",
    PythLegacy = "PythLegacy",
    SwitchboardV2 = "SwitchboardV2",
    PythPushOracle = "PythPushOracle"
}
interface BankConfigOpt {
    assetWeightInit: BigNumber | null;
    assetWeightMaint: BigNumber | null;
    liabilityWeightInit: BigNumber | null;
    liabilityWeightMaint: BigNumber | null;
    depositLimit: BigNumber | null;
    borrowLimit: BigNumber | null;
    riskTier: RiskTier | null;
    totalAssetValueInitLimit: BigNumber | null;
    interestRateConfig: InterestRateConfig | null;
    operationalState: OperationalState | null;
    oracle: {
        setup: OracleSetup;
        keys: PublicKey[];
    } | null;
    oracleMaxAge: number | null;
    permissionlessBadDebtSettlement: boolean | null;
}
interface BankConfigOptRaw {
    assetWeightInit: WrappedI80F48 | null;
    assetWeightMaint: WrappedI80F48 | null;
    liabilityWeightInit: WrappedI80F48 | null;
    liabilityWeightMaint: WrappedI80F48 | null;
    depositLimit: BN | null;
    borrowLimit: BN | null;
    riskTier: {
        collateral: {};
    } | {
        isolated: {};
    } | null;
    totalAssetValueInitLimit: BN | null;
    interestRateConfig: InterestRateConfigRaw | null;
    operationalState: {
        paused: {};
    } | {
        operational: {};
    } | {
        reduceOnly: {};
    } | null;
    oracle: {
        setup: {
            none: {};
        } | {
            pythLegacy: {};
        } | {
            switchboardV2: {};
        } | {
            pythPushOracle: {};
        };
        keys: PublicKey[];
    } | null;
    oracleMaxAge: number | null;
    permissionlessBadDebtSettlement: boolean | null;
}
declare function serializeBankConfigOpt(bankConfigOpt: BankConfigOpt): BankConfigOptRaw;
declare function parseRiskTier(riskTierRaw: RiskTierRaw): RiskTier;
declare function parseOracleSetup(oracleSetupRaw: OracleSetupRaw): OracleSetup;
declare function computeMaxLeverage(depositBank: Bank, borrowBank: Bank): {
    maxLeverage: number;
    ltv: number;
};
declare function computeLoopingParams(principal: Amount, targetLeverage: number, depositBank: Bank, borrowBank: Bank, depositOracleInfo: OraclePrice, borrowOracleInfo: OraclePrice): {
    borrowAmount: BigNumber;
    totalDepositAmount: BigNumber;
};
export type { InterestRateConfig, BankConfigOpt, BankConfigOptRaw };
export { Bank, BankConfig, RiskTier, OperationalState, OracleSetup, parseRiskTier, parseOracleSetup, serializeBankConfigOpt, computeMaxLeverage, computeLoopingParams, };
//# sourceMappingURL=bank.d.ts.map